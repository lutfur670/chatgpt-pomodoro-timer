<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Professional Kanban-style task management web app built with HTML, Tailwind CSS, and vanilla JavaScript. Supports drag-and-drop, add/edit/delete tasks, and localStorage persistence.">
  <meta name="keywords" content="task manager, kanban board, productivity, vanilla javascript, tailwind css">
  <title>Kanban Task Manager</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .task-card {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .task-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body class="bg-gray-50 font-sans">

<!-- HEADER -->
<header class="bg-white shadow-md">
  <div class="max-w-7xl mx-auto px-8 py-6 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-gray-800">Kanban Task Manager</h1>
    <button id="addTaskBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded shadow">
      + Add Task
    </button>
  </div>
</header>

<!-- MAIN KANBAN BOARD -->
<main class="max-w-7xl mx-auto px-8 py-8">
  <div id="board" class="grid grid-cols-1 sm:grid-cols-3 gap-6">

    <!-- To Do Column -->
    <div class="bg-gray-100 rounded-xl p-4 flex flex-col h-[600px]">
      <h2 class="text-lg font-semibold mb-4">To Do</h2>
      <div id="todo" class="flex-1 flex flex-col gap-3 overflow-y-auto"></div>
    </div>

    <!-- In Progress Column -->
    <div class="bg-gray-100 rounded-xl p-4 flex flex-col h-[600px]">
      <h2 class="text-lg font-semibold mb-4">In Progress</h2>
      <div id="inprogress" class="flex-1 flex flex-col gap-3 overflow-y-auto"></div>
    </div>

    <!-- Done Column -->
    <div class="bg-gray-100 rounded-xl p-4 flex flex-col h-[600px]">
      <h2 class="text-lg font-semibold mb-4">Done</h2>
      <div id="done" class="flex-1 flex flex-col gap-3 overflow-y-auto"></div>
    </div>

  </div>
</main>

<!-- TASK MODAL -->
<div id="taskModal" class="fixed inset-0 bg-black/40 flex items-center justify-center hidden">
  <div class="bg-white rounded-2xl shadow-lg p-6 w-96">
    <h3 class="text-xl font-semibold mb-4" id="modalTitle">Add Task</h3>
    <input type="text" id="taskInput" class="w-full border border-gray-300 rounded px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="Task title" />
    <select id="taskColumn" class="w-full border border-gray-300 rounded px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400">
      <option value="todo">To Do</option>
      <option value="inprogress">In Progress</option>
      <option value="done">Done</option>
    </select>
    <div class="flex justify-end gap-3">
      <button id="cancelTask" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">Cancel</button>
      <button id="saveTask" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Save</button>
    </div>
  </div>
</div>

<script>
  // ====== Data ======
  let tasks = JSON.parse(localStorage.getItem('kanbanTasks')) || [];
  let editId = null;

  // ====== DOM Elements ======
  const todoCol = document.getElementById('todo');
  const inProgressCol = document.getElementById('inprogress');
  const doneCol = document.getElementById('done');
  const board = document.getElementById('board');

  const modal = document.getElementById('taskModal');
  const taskInput = document.getElementById('taskInput');
  const taskColumn = document.getElementById('taskColumn');
  const saveBtn = document.getElementById('saveTask');
  const cancelBtn = document.getElementById('cancelTask');
  const addTaskBtn = document.getElementById('addTaskBtn');
  const modalTitle = document.getElementById('modalTitle');

  // ====== Functions ======
  function saveTasks() {
    localStorage.setItem('kanbanTasks', JSON.stringify(tasks));
  }

  function renderTasks() {
    // Clear all columns
    todoCol.innerHTML = '';
    inProgressCol.innerHTML = '';
    doneCol.innerHTML = '';

    tasks.forEach(task => {
      const card = document.createElement('div');
      card.className = 'task-card bg-white p-3 rounded shadow cursor-move';
      card.draggable = true;
      card.dataset.id = task.id;

      card.innerHTML = `
        <p class="mb-2">${task.title}</p>
        <div class="flex justify-end gap-2 text-gray-500">
          <button class="editBtn hover:text-blue-500" title="Edit Task">âœï¸</button>
          <button class="deleteBtn hover:text-red-500" title="Delete Task">ğŸ—‘ï¸</button>
        </div>
      `;

      // Drag Events
      card.addEventListener('dragstart', e => {
        e.dataTransfer.setData('text/plain', task.id);
        setTimeout(() => card.classList.add('opacity-50'), 0);
      });
      card.addEventListener('dragend', e => card.classList.remove('opacity-50'));

      // Edit
      card.querySelector('.editBtn').addEventListener('click', () => {
        editId = task.id;
        taskInput.value = task.title;
        taskColumn.value = task.column;
        modalTitle.textContent = 'Edit Task';
        modal.classList.remove('hidden');
      });

      // Delete
      card.querySelector('.deleteBtn').addEventListener('click', () => {
        tasks = tasks.filter(t => t.id !== task.id);
        saveTasks();
        renderTasks();
      });

      // Append to correct column
      if(task.column === 'todo') todoCol.appendChild(card);
      else if(task.column === 'inprogress') inProgressCol.appendChild(card);
      else if(task.column === 'done') doneCol.appendChild(card);
    });
  }

  function openModal() {
    editId = null;
    taskInput.value = '';
    taskColumn.value = 'todo';
    modalTitle.textContent = 'Add Task';
    modal.classList.remove('hidden');
  }

  function closeModal() {
    modal.classList.add('hidden');
  }

  saveBtn.addEventListener('click', () => {
    const title = taskInput.value.trim();
    const column = taskColumn.value;

    if(title === '') return alert('Task title cannot be empty!');

    if(editId) {
      // Edit existing
      const task = tasks.find(t => t.id === editId);
      task.title = title;
      task.column = column;
    } else {
      // Add new
      tasks.push({
        id: Date.now().toString(),
        title,
        column
      });
    }

    saveTasks();
    renderTasks();
    closeModal();
  });

  cancelBtn.addEventListener('click', closeModal);
  addTaskBtn.addEventListener('click', openModal);

  // ===== Drag & Drop Column Handling =====
  [todoCol, inProgressCol, doneCol].forEach(col => {
    col.addEventListener('dragover', e => e.preventDefault());
    col.addEventListener('drop', e => {
      e.preventDefault();
      const id = e.dataTransfer.getData('text/plain');
      const task = tasks.find(t => t.id === id);
      task.column = col.id;
      saveTasks();
      renderTasks();
    });
  });

  // Initial Render
  renderTasks();
</script>

</body>
</html>
